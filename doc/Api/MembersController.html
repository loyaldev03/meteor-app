<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: Api::MembersController
  
    &mdash; Phoenix Api Documentation
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../';
  framesUrl = "../frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/rest_plugin.js"></script>


	<style type="text/css">
		body {
			overflow-x: hidden;
			overflow-y: auto;
			padding: 0 !important;
			margin: 0 !important;
			width: 100%;
		}
		#toc {
		  height: 100%;
		  right: 0;
		  position: fixed;
		  top: 0;
		  width: 230px;
	  }
	  #header {
	    position: fixed;
	    top: 0;
	    z-index: 1001;
	  }
	  #header #search {
	    position: fixed;
	    top: 0;
	    right: 8px;
	    z-index: 1001;
	  }
	  #content {
	    margin-right: 285px;
	    position: relative;
	    padding: 20px;
	    z-index: 1;
	  }
		#toc .title {display: none;}
		#toc a:link, #content a:visited { text-decoration: none; color: #05a; }
		#toc a:hover { background: #ffffa5; }
		pre code {
			display: block;
			background: #EAF0FF;
			padding: 12px;
			line-height: 1.9em;
		}
		a.back {
			font-size: 1.2em;
			padding: 4px;
		}
		p.method_desc {
			padding: 16px 0 0 14px;
			font-size: 1.4em;
			font-weight: bold;
		}
		h2 {
			margin: 2.4em 0 0.5em;
		}
		.service h2 + p {
			font-size: 1.2em;
			margin-bottom: 62px;
		}
		.method {
			display: block;
			margin-top: 40px;
			padding-top: 0;
			position: relative;
		}
		h3 {
			font-size: 1.2em;
			font-weight: normal;
			padding-top: 6px;
			margin-bottom: -6px;
		}
		h4 {
			margin: 0;
		}
		#resources {
			padding: 14px 20px 52px;
		}
		#resources li {
			border-right: 1px solid #0055AA;
			display: block;
			font-size: 1.4em;
			float: left;
			padding-right: 14px;
			padding-left: 12px;
		}
		.resource_url {
			border: 1px solid white;
			display: block;
			background: #EAF0FF;
			margin-top: 11px;
			padding: 12px 12px 18px;
		}
		#search_frame #search {
			display: none;
		}
		.parameters, .response_fields {
			background: none repeat scroll 0 0 #EAF0FF;
		}
		.parameters .required {
			background: #d5e1ff;
			padding: 12px;
			border: 1px solid white;
		}
		.parameters .optional, .response_fields {
			padding: 18px 12px 12px 12px;
			border: 1px solid white;
		}
		.parameters .optional ul li, .parameters .required li, .response_fields li {
			display: block;
			padding: 4px 0 0 6px;
		}
		.parameters .optional ul li .name, .parameters .required li .name, .response_fields li .name {
			font-weight: bold;
		}
		.parameters .optional ul li .text, .parameters .required li .text, .response_fields li .text {
			display: block;
		}
		.examples {
			padding: 32px 12px 12px 12px;
		}
		.example {			
			border-bottom: 1px solid #BBB;
			display: block;
			padding: 18px 0 26px;
			margin-bottom: 14px;
			margin-top: 8px;
		}
		.example .description {
			display: block;
			font-size: 1.2em;
			margin: 8px 0;
		}
		
		.example .hash {
			display: block;
			background: #EEF;
			font-size: 1.1em;
			border-radius: 4px;
			box-shadow: inset 0 2px 5px rgba(0,0,0,0.1);
			padding: 12px;
		}
		
		.example .hash .type {
			display: block;
			font-size: 0.8em;
			color: #99A;
			padding-bottom: 6px;
		}
		
		.example .hash.request {
			border-bottom-left-radius: 0;
			border-bottom-right-radius: 0;
		}
		
		.example .hash.response {
			border-top: 1px solid white;
			border-top-left-radius: 0;
			border-top-right-radius: 0;
		}
		
		pre.code.json {
		  margin: 0;
		}
		
		pre.code.json code {
		  position: relative;
		  border: 1px solid transparent;
		  border-radius: 6px;
		}
		
		pre.code.json code:hover {
		  background: #d4e5fe;
		}
		
		pre.code.json code:active {
		  background: #c1d8fb;
		}
	</style>
	<script type="text/javascript">
		//<![CDATA[
		
		  function setup_log() {
		    $("pre.code.json").attr("title", "click to inspect in browser debugger: console.log()");
		    $("pre.code.json").css("cursor", "pointer");
		    $("pre.code.json").click(function(){
		      var code = $(this).find("code");
		      console.log(code.html());
		      console.log(JSON.parse(code.html()));
		    });
		  }
		
			function setup_toc() {
	 		  if ($('#content').length === 0) return;
			  var _toc = $('<ol class="top"></ol>');
			  var show = false;
			  var toc = _toc;
			  var counter = 0;
			  var tags = ['h2', 'h3', 'h4', 'h5', 'h6'];
			  var i;
			  if ($('#content h1').length > 1) tags.unshift('h1');
			  for (i = 0; i < tags.length; i++) { tags[i] = '#content ' + tags[i]; }
			  var lastTag = parseInt(tags[0][1], 10);
			  $(tags.join(', ')).each(function() {
			    if (this.id == "content") return;
			    show = true;
			    var thisTag = parseInt(this.tagName[1], 10);
			    if (this.id.length === 0) {
			      var proposedId = $(this).text().replace(/[^a-z0-9-]/ig, '_');
			      if ($('#' + proposedId).length > 0) { proposedId += counter; counter++; }
			      this.id = proposedId;
			    }
			    if (thisTag > lastTag) { 
			      for (i = 0; i < thisTag - lastTag; i++) { 
			        var tmp = $('<ol/>'); toc.append(tmp); toc = tmp; 
			      } 
			    }
			    if (thisTag < lastTag) { 
			      for (i = 0; i < lastTag - thisTag; i++) toc = toc.parent(); 
			    }
			    toc.append('<li><a href="#' + this.id + '">' + $(this).text() + '</a></li>');
			    lastTag = thisTag;
			  });
			  if (!show) return;
			  html = '<div id="toc"><p class="title"><a class="hide_toc" href="#"><strong>Table of Contents</strong></a> <small>(<a href="#" class="float_toc">left</a>)</small></p></div>';
			  $('#content').prepend(html);
			  $('#toc').append(_toc);
			  $('#toc .hide_toc').toggle(function() { 
			    $('#toc .top').slideUp('fast');
			    $('#toc').toggleClass('hidden');
			    $('#toc .title small').toggle();
			  }, function() {
			    $('#toc .top').slideDown('fast');
			    $('#toc').toggleClass('hidden');
			    $('#toc .title small').toggle();
			  });
			  $('#toc .float_toc').toggle(function() { 
			    $(this).text('float');
			    $('#toc').toggleClass('nofloat');
			  }, function() {
			    $(this).text('left');
			    $('#toc').toggleClass('nofloat');
			  });
			}
			$(document).ready(function(){
			  setup_toc();
			  setup_log();
			});
		//]]>
	</script>
  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="search">
  <!-- <a id="topic_list_link" href="#">Topic List</a> -->
  <a id="resource_list_link" href="#">Resources</a>
</div>

    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content" style="padding-top: 12px;">
		<div class="service">
  <h1 class="noborder title">Phoenix Api Documentation</h1>
    <a class="back" href="../index.html" title="back to the overview">&laquo; back to overview</a>
    <h2>Members</h2>
    
  <div id="Services" class="method_details_list">
    
		<div class="method">
			<p class="method_desc">Submits a member to be created. This method will call the method enroll on member model. It will validate
the member's data (including its credit card) and, in case it is correct, it will create and save the member.
It will also send a welcome email and charge the enrollment to the member's credit card.</p>
			<h3 class="resource_url"><strong>/api/v1/members</strong> [POST]</h3>

			<div class="parameters">	
				
					<div class="required">
						<h4>Required Parameters</h4>
						
							<ul>
								<li>
									<span class="name">api_key</span>
									<span class="type">String</span>
									<span class="text">Agent's authentication token. This token allows us to check if the agent is allowed to request this action.</span>
								</li>
							</ul>
						
							<ul>
								<li>
									<span class="name">member</span>
									<span class="type">Hash</span>
									<span class="text">Information related to the member that is sumbitting the enroll. It also contains information related to the enrollment (this will be stored as enrollment_info). It must have the following information:
<ul>
  <li><strong>first_name</strong> The first name of the member that is enrolling. </li>
  <li><strong>last_name</strong> The last name of the member that is enrolling. </li>
  <li><strong>address</strong> The address of the member that is being enrolled. (regex we use to validate: /^[A-Za-z0-9àáâäãåèéêëìíîïòóôöõøùúûüÿýñçčšžÀÁÂÄÃÅÈÉÊËÌÍÎÏÒÓÔÖÕØÙÚÛÜŸÝÑßÇŒÆČŠŽ∂ð\/ '-.,#]+$/) </li>
  <li><strong>city</strong> City from where the member is from. </li>
  <li><strong>state</strong> The state standard code where the member is from. </li>
  <li><strong>zip</strong> Member's address's zip code. We are accpeting only formats like: xxxxx or xxxxx-xxxx for US. Only numbers. In case the member is from Canada, we accept canadian zips with the valid format (LNL NLN or LNLNLN where 'L' stands for letters and 'N' for numbers.) </li>
  <li><strong>country</strong> The country standard code where the member is from. This code has a length of 2 digits. (Eg: US for United States). </li>
  <li><strong>phone_country_code</strong> First field of the phone number. This is the number related to the country the phone number is from. (Eg. For United States it would be "1"). </li>
  <li><strong>phone_area_code</strong> Second field of the phone number. This is the number related to the area the phone number is from. </li>
  <li><strong>phone_local_number</strong> Third and last field of the phone_number. This is the local number where the member will be reached. </li>
  <li><strong>email</strong> Members personal email. This mail will be one of our contact method and every mail will be send to this. We recommend frontend to validate mails with the following formts like: xxxxxxxxx@xxxx.xxx.xx or xxxxxx+xxx@xxxx.xxx.xx </li>
  <li><strong>gender</strong> Gender of the member. The values we are recieving are "M" for male or "F" for female. [optional] </li>
  <li><strong>type_of_phone_number</strong> Type of the phone number the member has input (home, mobile, others). [optional] </li>
  <li><strong>external_id</strong> Member's id related to an external platform that we don't administrate. [optional] </li>
  <li><strong>terms_of_memberhip_id</strong> This is the id of the term of membership the member is enrolling with. With this param we will set some features such as provisional days or amount of club cash the member will start with. It is present at member level.  </li>
  <li><strong>enrollment_amount</strong> Amount of money that takes to enroll. It is present at member level. </li>
  <li><strong>birth_date</strong> Birth date of the member. This date is stored with format "yyyy-mm-dd" [optional] </li>
  <li><strong>prospect_id</strong> Id of the prospect the enrollment info is related to. [optional] </li>
  <li><strong>product_sku</strong> Freeform text that is representative of the SKU. [optional]</li>
  <li><strong>product_description</strong> Description of the selected product. [optional]</li>
  <li><strong>mega_channel</strong> [optional] </li>
  <li><strong>marketing_code</strong> multi-team [optional] </li>
  <li><strong>fulfillment_code</strong> Id of the fulfillment we are sending to our member. (car-flag). [optional]</li>
  <li><strong>ip_address</strong> Ip address from where the enrollment is being submitted. [optional] </li>
  <li><strong>user_agent</strong> Information related to the browser and computer from where the enrollment is being submitted. [optional] </li>
  <li><strong>referral_host</strong> Link where is being redirect when after subimiting the enroll. (It shows the params in it). [optional]</li>
  <li><strong>referral_parameters</strong> [optional]</li>
  <li><strong>referral_path</strong> [optional]</li>
  <li><strong>visitor_id</strong> User ID alias UID is an md5 hash of the user's IP address and user-agent information. [optional]</li>
  <li><strong>landing_url</strong> Url from where the submit comes from. [optional]</li>
  <li><strong>preferences</strong> Information about the preferences selected when enrolling. This will be use to know about the member likes. This information is selected by the member. This information is stored with format as hash encoded with json. [optional] </li>
  <li><strong>cookie_value</strong> Cookie from where the enrollment is being submitted.[optional]</li>
  <li><strong>cookie_set</strong> If the cookie_value is being recieved or not. It also informs if the client has setted a cookie on his side. [optional]</li>
  <li><strong>campaign_medium</strong> [optional]</li>
  <li><strong>campaign_description</strong> The name of the campaign. [optional]</li>
  <li><strong>campaign_medium_version</strong> [optional]</li>
  <li><strong>joint</strong> It shows if it is set as type joint. It is use to see if at the end of the contract we have with the partner, we share the member's informatión with him. joint=1 means we will share this informatión. If it is null, we will automaticaly set it as 0. This is an exclusive value, it can be seted using 1 or 0, or true or false. It is present at member level.  [optional]</li>
  <li><strong>credit_card</strong> Hash with credit cards information. It must have the following information:</li>
  <ul>
    <li><strong>number</strong> Number of member's credit card, from where we will charge the membership or any other service. This value won't be save, but instead we will save a token obtained from the payment gateway. (We accept numbers and characters like "-", whitespaces and "/") </li>
    <li><strong>expire_month</strong> The month (in numbers) in which the credit card will expire. Eg. For june it would be 6. </li>
    <li><strong>expire_year</strong> The year (in numbers) in which the credit card will expire. Have in mind it is the complete year with four digits (Eg. 2014) </li>
  </ul>
</ul></span>
								</li>
							</ul>
						
					</div>
				

				
					<div class="optional">
						<h4>Optional Parameters</h4>
						
							<ul>
								<li>
									<span class="name">setter</span>
									<span class="type">Hash</span>
									<span class="text">Variable used to pass some boolean values as "cc_blank". It must have the following information:
<ul>
  <li><strong>cc_blank</strong> Boolean variable which will tell us to allow or not enrolling a member with a blank credit card. If it is true, send credit_card with the following attributes: number=>"0000000000" and expire_month and expired_year setted as today's month and year respectively. </li>
  <li><strong>skip_api_sync</strong> Boolean variable which tell us if we have to sync or not user to remote api (e.g drupal). If this value is true, we will skip the synchronization. (1=true, 0=false) [optional]</li>
</ul></span>
								</li>
							</ul>
						
					</div>
				
			</div><!-- parameters -->
			
			
				<div class="response_fields">
					<h4>Response Fields</h4>
					
						<ul>
							<li>
								<span class="name">message</span>
								<span class="type">String</span>
								<span class="text">Shows the method results and also informs the errors.</span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">code</span>
								<span class="type">String</span>
								<span class="text">Code related to the method result.</span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">member_id</span>
								<span class="type">Integer</span>
								<span class="text">Member's id. Integer autoincrement value that is used by platform. This value will be returned only if the member is enrolled successfully.</span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">errors</span>
								<span class="type">Hash</span>
								<span class="text">A hash with members and credit card errors.
<ul>
  <li> <strong>key</strong> member's field name with error. (Eg: first_name, last_name, etc.). In the particular case that one or more of credit_card's field are wrong, the key will be "credit_card", and the value will be a hash that follows the same logic as this error hash. (Eg: "credit_card":{"number":["is required"],"expire_month":["is required"],"expire_year":["is required"]})  </li>
  <li> <strong>value</strong> Array of strings with errors. (Eg: ["can't be blank","is invalid"]). </li>
</ul></span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">autologin_url</span>
								<span class="type">String</span>
								<span class="text">Url provided by Drupal, used to autologin a member into it. This URL is used by campaigns in order to redirect members to their drupal account. This value wll be returned as blank in case the club is not related to drupal.</span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">api_role</span>
								<span class="type">String</span>
								<span class="text">Only for drupal. We will send the members's api role id within this field.</span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">bill_date</span>
								<span class="type">String</span>
								<span class="text">Only for drupal. Date when the billing will be done. In case bill date is not set (for example for applied member) the date will be send as blank.</span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">status</span>
								<span class="type">String</span>
								<span class="text">Member's membership status after enrolling. There are two possibles status when the member is enrolled:
<ul>
  <li><strong>provisional</strong> The member will be within a period of provisional. This period will be set according to the subscription plan the member was enrolled with. Once the period finishes, the member will be billed, and if it is successful, it will be set as 'active'. </li>
  <li><strong>applied</strong> Member is in confirmation process. An agent will be in charge of accepting or rejecting the enroll. In case the enroll is accepeted, the member will be set as provisional. On the other hand, if the member is reject, it will be set as lapsed. </li>
</ul></span>
							</li>
						</ul>
					
				</div>
			
			
			
				<div class="examples">
					<h4>Examples</h4>
					
						<div class="example">
							
							
							
							<span class="description">
								
									
										Requesting enroll of a valid member, with params in json format.
									
								
							</span>
							<span class="hash request">
								<strong class="type">Request</strong>
								
									
										curl -v -k -X POST --data-ascii "{\"member\":{\"first_name\":\"alice\",\"last_name\":\"brennan\", \"address\":\"SomeSt\",\"city\":\"Dresden\",\"state\":\"AL\",\"gender\":\"\",\"zip\":\"12345\",\"phone_country_code\":\"1\",\"phone_area_code\":\"123\",\"phone_local_number\":\"1123\",\"birth_date\":\"1989-09-03\",\"email\":\"alice@brennan.com\",\"country\":\"US\",\"prospect_id\":\"deadbeef\", \"enrollment_amount\":\"0.0\",\"terms_of_membership_id\":\"1\",\"credit_card\":{\"number\":\"371449635398431\",\"expire_month\":\"2\",\"expire_year\":\"2014\"},\"product_sku\":\"KIT-CARD\",\"landing_url\":\"http://www.google.com\",\"mega_channel\":\"super channel\",\"marketing_code\":\"marketing code\",\"fulfillment_code\":\"1\",\"ip_address\":\"192.168.1.1\",\"user_agent\":\"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537...\"},\"api_key\":\"o6ESwPCNtsMkJnDLzvpC\"}" -H "Content-Type: application/json" https://dev.affinitystop.com:3000/api/v1/members
									
								
							</span>
							<span class="hash response">
								<strong class="type">Response</strong>
								
									
										{"message":"Member enrolled successfully $0.0 on TOM(1) -test2-","code":"000","member_id":11349950166,"autologin_url":"","status":"provisional"}
									
								
							</span>
							<span class="description">
								
									
										Example response to a valid request
									
								
							</span>
						</div>
					
						<div class="example">
							
							
							
							<span class="description">
								
									
										Requesting enroll sending some params as blank
									
								
							</span>
							<span class="hash request">
								<strong class="type">Request</strong>
								
									
										curl -v -k -X POST --data-ascii "{\"member\":{\"first_name\":\"\",\"last_name\":\"\", \"address\":\"\",\"city\":\"\",\"state\":\"\",\"gender\":\"\",\"zip\":\"\",\"phone_country_code\":\"\",\"phone_area_code\":\"\",\"phone_local_number\":\"\",\"birth_date\":\"1989-09-03\",\"email\":\"alice@brennan.com\",\"country\":\"US\",\"prospect_id\":\"\", \"enrollment_amount\":\"0.0\",\"terms_of_membership_id\":\"1\",\"product_sku\":\"KIT-CARD\",\"landing_url\":\"http://www.google.com\",\"mega_channel\":\"super channel\",\"marketing_code\":\"marketing code\",\"fulfillment_code\":\"1\",\"ip_address\":\"192.168.1.1\",\"user_agent\":\"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537...\"},\"api_key\":\"DyqgeuHrxmb9QA8gsU22\"}" -H "Content-Type: application/json" https://dev.affinitystop.com:3000/api/v1/members
									
								
							</span>
							<span class="hash response">
								<strong class="type">Response</strong>
								
									
										{"message":"Member information is invalid.","code":"405","errors":{"phone_country_code":["can't be blank","is not a number","is too short (minimum is 1 characters)"],"phone_area_code":["can't be blank","is not a number","is too short (minimum is 1 characters)"],"phone_local_number":["can't be blank","is not a number","is too short (minimum is 1 characters)"],"first_name":["can't be blank","is invalid"],"last_name":["can't be blank","is invalid"],"address":["is invalid"],"state":["can't be blank","is invalid"],"city":["can't be blank","is invalid"],"zip":["can't be blank","The zip code is not valid for the selected country."],"credit_card":{"number":["is required"],"expire_month":["is required"],"expire_year":["is required"]}}}
									
								
							</span>
							<span class="description">
								
									
										Example response to a request we are sending params as blank. (Params sent as blank: first_name, last_name, address, city, state, gender, zip, phone_country_code, phone_area_code, phone_local_number and credit_card's information)
									
								
							</span>
						</div>
					
				</div>
			
		</div>	
    
		<div class="method">
			<p class="method_desc">Updates member's data. You may only send fields that has change only. In case a credit_card field has been change, make sure to send all credit cards fields again (even the ones that has not change).</p>
			<h3 class="resource_url"><strong>/api/v1/members/:id</strong> [PUT]</h3>

			<div class="parameters">	
				
					<div class="required">
						<h4>Required Parameters</h4>
						
							<ul>
								<li>
									<span class="name">api_key</span>
									<span class="type">String</span>
									<span class="text">Agent's authentication token. This token allows us to check if the agent is allowed to request this action.</span>
								</li>
							</ul>
						
							<ul>
								<li>
									<span class="name">id</span>
									<span class="type">Integer</span>
									<span class="text">Member's ID. Integer autoincrement value that is used by platform. Have in mind this is part of the url.</span>
								</li>
							</ul>
						
							<ul>
								<li>
									<span class="name">member</span>
									<span class="type">Hash</span>
									<span class="text">Information related to the member that is sumbitting the enroll. It also contains information related to the enrollment (this will be stored as enrollment_info). 
<ul>
  <li><strong>first_name</strong> The first name of the member that is enrolling. [optional] </li>
  <li><strong>last_name</strong> The last name of the member that is enrolling. [optional] </li>
  <li><strong>address</strong> The address of the member that is being enrolled.  (regex we use to validate: /^[A-Za-z0-9àáâäãåèéêëìíîïòóôöõøùúûüÿýñçčšžÀÁÂÄÃÅÈÉÊËÌÍÎÏÒÓÔÖÕØÙÚÛÜŸÝÑßÇŒÆČŠŽ∂ð\/ '-.,#]+$/) [optional] </li>
  <li><strong>city</strong> City from where the member is from. [optional]</li>
  <li><strong>state</strong> The state standard code where the member is from. [optional]</li>
  <li><strong>zip</strong> Member's address's zip code. We are accpeting only formats like: xxxxx or xxxxx-xxxx for US. Only numbers. In case the member is from Canada, we accept canadian zips with the valid format (LNL NLN or LNLNLN where 'L' stands for letters and 'N' for numbers.) [optional] </li>
  <li><strong>country</strong> The country standard code where the member is from. This code has a length of 2 digits. (Eg: US for United States). [optional]</li>
  <li><strong>phone_country_code</strong> First field of the phone number. This is the number related to the country the phone number is from. (Eg. For United States it would be "1"). [optional]</li>
  <li><strong>phone_area_code</strong> Second field of the phone number. This is the number related to the area the phone number is from. [optional]</li>
  <li><strong>phone_local_number</strong> Third and last field of the phone_number. This is the local number where the member will be reached. [optional]</li>
  <li><strong>email</strong> Members personal email. This mail will be one of our contact method and every mail will be send to this. We recommend frontend to validate mails with the following formts like: xxxxxxxxx@xxxx.xxx.xx or xxxxxx+xxx@xxxx.xxx.xx. [optional]</li>
  <li><strong>gender</strong> Gender of the member. The values we are recieving are "M" for male or "F" for female. [optional]</li>
  <li><strong>type_of_phone_number</strong> Type of the phone number the member has input (home, mobile, others). [optional] </li>
  <li><strong>birth_date</strong> Birth date of the member. This date is stored with format "yyyy-mm-dd" [optional]</li>
  <li><strong>member_group_type_id</strong> Id of the member's group type where he belongs to. Each club can has many classifications for its member's, like 'VIP' or 'Celebrity'. [optional]</li>
  <li><strong>external_id</strong> Member's id related to an external platform that we don't administrate. [optional]</li>
  <li><strong>api_id</strong> Id related to our frontend. This is only being use when we are hosting the frontend. (e.g. Autologin URL - Update member data). [optional]</li>
  <li><strong>preferences</strong> Information about the preferences selected when enrolling. This will be use to know about the member likes. This information is selected by the member. This information is stored with format as hash encoded with json. [optional] </li>
  <li><strong>credit_card</strong> Hash with credit cards information. [optional]</li>
  <ul>
    <li><strong>number</strong> Number of member's credit card, from where we will charge the membership or any other service. This value won't be save, but instead we will save a token obtained from the payment gateway. (We accept numbers and characters like "-", whitespaces and "/") </li>
    <li><strong>expire_month</strong> The month (in numbers) in which the credit card will expire. Eg. For june it would be 6. </li>
    <li><strong>expire_year</strong> The year (in numbers) in which the credit card will expire. Have in mind it is the complete year with four digits (Eg. 2014) </li>
  </ul>
</ul></span>
								</li>
							</ul>
						
					</div>
				

				
					<div class="optional">
						<h4>Optional Parameters</h4>
						
							<ul>
								<li>
									<span class="name">setter</span>
									<span class="type">Hash</span>
									<span class="text">Variable used to pass some boolean values as "wrong_phone_number".
<ul>
  <li><strong>wrong_phone_number</strong> Boolean value that (if it is true) it will tell us to unset member's phone_number as wrong. (It will set wrong_phone_number as nil) [optional]</li>
  <li><strong>batch_update</strong> Boolean variable which tell us if this update was made by a member or by a system. Send 1 if you want batch_update otherwise dont send this attribute (different operations will be stored) [optional]</li>
  <li><strong>skip_api_sync</strong> Boolean variable which tell us if we have to sync or not user to remote api. Send 1 if you want to skip sync otherwise dont send this attribute. [optional] (e.g drupal)</li>
</ul></span>
								</li>
							</ul>
						
					</div>
				
			</div><!-- parameters -->
			
			
				<div class="response_fields">
					<h4>Response Fields</h4>
					
						<ul>
							<li>
								<span class="name">message</span>
								<span class="type">String</span>
								<span class="text">Shows the method results and also informs the errors.</span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">code</span>
								<span class="type">String</span>
								<span class="text">Code related to the method result.</span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">member_id</span>
								<span class="type">Integer</span>
								<span class="text">Member's id. Integer autoincrement value that is used by platform. It will be returned only when the request was a success.</span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">errors</span>
								<span class="type">Hash</span>
								<span class="text">A hash with members errors.
<ul>
  <li> <strong>key</strong> member's field name with error. (Eg: first_name, last_name, etc.). </li>
  <li> <strong>value</strong> Array of strings with errors. (Eg: ["can't be blank","is invalid"]). </li>
</ul></span>
							</li>
						</ul>
					
				</div>
			
			
			
				<div class="examples">
					<h4>Examples</h4>
					
						<div class="example">
							
							
							
							<span class="description">
								
									
										Requesting member update with valid params and in json format.
									
								
							</span>
							<span class="hash request">
								<strong class="type">Request</strong>
								
									
										curl -v -k -X PUT --data-ascii "{\"member\":{\"first_name\":\"Megan\",\"last_name\":\"Brenann\", \"address\":\"SomeSt\",\"city\":\"Dresden\",\"state\":\"AL\",\"gender\":\"m\",\"zip\":\"12345\",\"phone_country_code\":\"1\",\"phone_area_code\":\"123\",\"phone_local_number\":\"1123\",\"birth_date\":\"1989-09-03\",\"email\":\"alice@brennan.com\",\"country\":\"US\",\"credit_card\":{\"number\":\"371449635398431\",\"expire_month\":\"2\",\"expire_year\":\"2014\"}},\"api_key\":\"o6ESwPCNtsMkJnDLzvpC\"}" -H "Content-Type: application/json" https://dev.affinitystop.com:3000/api/v1/members/1
									
								
							</span>
							<span class="hash response">
								<strong class="type">Response</strong>
								
									
										{"message":"Member updated successfully","code":"000","member_id":1}
									
								
							</span>
							<span class="description">
								
									
										Example response to a valid request
									
								
							</span>
						</div>
					
				</div>
			
		</div>	
    
		<div class="method">
			<p class="method_desc">Returns information related to member's information, credit card, current membership and enrollment information.</p>
			<h3 class="resource_url"><strong>/api/v1/members/:id/profile</strong> [POST]</h3>

			<div class="parameters">	
				
					<div class="required">
						<h4>Required Parameters</h4>
						
							<ul>
								<li>
									<span class="name">api_key</span>
									<span class="type">String</span>
									<span class="text">Agent's authentication token. This token allows us to check if the agent is allowed to request this action.</span>
								</li>
							</ul>
						
							<ul>
								<li>
									<span class="name">id</span>
									<span class="type">Integer</span>
									<span class="text">Member's ID. Integer autoincrement value that is used by platform. Have in mind this is part of the url.</span>
								</li>
							</ul>
						
					</div>
				

				
			</div><!-- parameters -->
			
			
				<div class="response_fields">
					<h4>Response Fields</h4>
					
						<ul>
							<li>
								<span class="name">credit_card</span>
								<span class="type">Hash</span>
								<span class="text">Information related to member's credit card.
<ul>
   <li><strong>last_4_digits</strong> Member's active credit card last four digits. </li>
   <li><strong>expire_month</strong> The month (in numbers) in which the credit card will expire. Eg. For june it would be 6. </li>
   <li><strong>expire_year</strong> The year (in numbers) in which the credit card will expire. Have in mind it is the complete year with four digits (Eg. 2014) </li>
</ul></span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">current_membership</span>
								<span class="type">Hash</span>
								<span class="text">Information related to the member's membership at the moment.
<ul>
   <li><strong>status</strong> String with member's current status. </li>
   <li><strong>join_date</strong> String with date when the member join. This date is updated each time the member is recovered, or it is saved the sale. It is in datetime with the offset format. (Eg: "2013-04-23T15:17:09-04:00" ) </li>
   <li><strong>cancel_date</strong> String with date schedule when the member will be canceled. If there is no date schedule this value will be null. It is in datetime with the offset format. If member does not have cancel date set, this value will be blank. (Eg: "2013-04-23T15:17:09-04:00" )  </li>
</ul></span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">member</span>
								<span class="type">Hash</span>
								<span class="text">Hash with member information.
<ul>
   <li><strong>first_name</strong> The first name of the member that is enrolling. We are not accepting any invalid character (like: #$"!#%&%"). </li>
   <li><strong>last_name</strong> The last name of the member that is enrolling. We are not accepting any invalid character (like: #$"!#%&%"). </li>
   <li><strong>address</strong> The address of the member that is being enrolled. </li>
   <li><strong>city</strong> City from where the member is from. </li>
   <li><strong>state</strong> The state standard code where the member is from. </li>
   <li><strong>zip</strong> Member's address's zip code. We are accpeting only formats like: xxxxx or xxxxx-xxxx for US. Only numbers. In case the member is from Canada, we accept canadian zips with the valid format (LNL NLN or LNLNLN where 'L' stands for letters and 'N' for numbers.) </li>
   <li><strong>phone_country_code</strong> First field of the phone number. This is the number related to the country the phone number is from. (Eg. For United States it would be "011"). </li>
   <li><strong>phone_area_code</strong> Second field of the phone number. This is the number related to the area the phone number is from. </li>
   <li><strong>phone_local_number</strong> Third and last field of the phone_number. This is the local number where the member will be reached. </li>
   <li><strong>phone_local_number</strong> Members personal email. This mail will be one of our contact method and every mail will be send to this. We are accepting mails with formtas like: xxxxxxxxx@xxxx.xxx.xx or xxxxxx+xxx@xxxx.xxx.xx </li>
   <li><strong>type_of_phone_number</strong> Type of the phone number the member has input (home, mobile, others). </li>
   <li><strong>birth_date</strong> Birth date of the member. This date is stored with format "yyyy-mm-dd" </li>
   <li><strong>gender</strong> Gender of the member. The values we are recieving are "M" for male or "F" for female. </li>
   <li><strong>bill_date</strong> Date when the billing will be done. It is in datetime with the offset format. If member does not have bill date set, this value will be blank. (Eg: "2013-04-23T15:17:09-04:00" ) </li>
   <li><strong>wrong_address</strong> Reason the member was set as undeliverable. </li>
   <li><strong>wrong_phone_number</strong> Reason the member was set as unreachable. </li>
   <li><strong>member_since_date</strong> Date when the member was created. It is in datetime with the offset format. </li>
   <li><strong>reactivation_times</strong> Integer value that tells us how many times this member was recovered. </li>
   <li><strong>blacklisted</strong> Boolean value that says if the member is blacklisted or not (true = blacklisted, false = not blacklisted) </li>
   <li><strong>external_id</strong> Member's id related to an external platform that we don't administrate. </li>
   <li><strong>member_group_type</strong> Group type the member belongs to. </li>
   <li><strong>preferences</strong> Information about the preferences selected when enrolling. This will be use to know about the member likes. </li></span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">message</span>
								<span class="type">String</span>
								<span class="text">Shows the method errors. This message will be only shown when there was an error.</span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">code</span>
								<span class="type">String</span>
								<span class="text">Code related to the method result.</span>
							</li>
						</ul>
					
				</div>
			
			
			
				<div class="examples">
					<h4>Examples</h4>
					
						<div class="example">
							
							
							
							<span class="description">
								
									
										Example of valid request.
									
								
							</span>
							<span class="hash request">
								<strong class="type">Request</strong>
								
									
										curl -v -k -X POST -d "api_key=DyqgeuHrxmb9QA8gsU22" https://dev.affinitystop.com:3000/api/v1/members/1/profile
									
								
							</span>
							<span class="hash response">
								<strong class="type">Response</strong>
								
									
										{"code":"000","member":{"first_name":"Megan","last_name":"Brenann","email":"alice@brennan.com","address":"SomeSt","city":"Dresden","state":"AL","zip":"12345","birth_date":"1989-09-03","phone_country_code":1,"phone_area_code":123,"phone_local_number":1123,"type_of_phone_number":"other","gender":"","bill_date":null,"wrong_address":null,"wrong_phone_number":null,"member_since_date":"2013-01-15T13:03:07-05:00","reactivation_times":0,"external_id":null,"blacklisted":false,"member_group_type":"VIP","preferences":{"example_color":"blue","example_team":"example"}},"credit_card":{"last_4_digits":"8431","expire_month":2,"expire_year":2014},"current_membership":{"status":"lapsed","join_date":"2013-01-15T13:03:19-05:00","cancel_date":"2013-04-10T20:00:00-04:00"}}
									
								
							</span>
							<span class="description">
								
									
										Example response to a valid request
									
								
							</span>
						</div>
					
				</div>
			
		</div>	
    
		<div class="method">
			<p class="method_desc">Updates member's club cash's data. Have in mind that in order to use this feature, member's club must allow club cash transaction within it.</p>
			<h3 class="resource_url"><strong>/api/v1/members/:id/club_cash</strong> [PUT]</h3>

			<div class="parameters">	
				
					<div class="required">
						<h4>Required Parameters</h4>
						
							<ul>
								<li>
									<span class="name">api_key</span>
									<span class="type">String</span>
									<span class="text">Agent's authentication token. This token allows us to check if the agent is allowed to request this action.</span>
								</li>
							</ul>
						
							<ul>
								<li>
									<span class="name">id</span>
									<span class="type">Integer</span>
									<span class="text">Member's ID. Integer autoincrement value that is used by platform. Have in mind this is part of the url.</span>
								</li>
							</ul>
						
							<ul>
								<li>
									<span class="name">amount</span>
									<span class="type">Float</span>
									<span class="text">club cash amount to be set on this member profile. We only accept numbers with up to two digits after the comma.</span>
								</li>
							</ul>
						
					</div>
				

				
					<div class="optional">
						<h4>Optional Parameters</h4>
						
							<ul>
								<li>
									<span class="name">expire_date</span>
									<span class="type">String</span>
									<span class="text">club cash expiration date. This date is stored with datetime format. (Format "yyyy-mm-dd")</span>
								</li>
							</ul>
						
					</div>
				
			</div><!-- parameters -->
			
			
				<div class="response_fields">
					<h4>Response Fields</h4>
					
						<ul>
							<li>
								<span class="name">message</span>
								<span class="type">String</span>
								<span class="text">Shows the method results and also informs the errors.</span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">code</span>
								<span class="type">String</span>
								<span class="text">Code related to the method result.</span>
							</li>
						</ul>
					
				</div>
			
			
			
				<div class="examples">
					<h4>Examples</h4>
					
						<div class="example">
							
							
							
							<span class="description">
								
									
										Example of valid request.
									
								
							</span>
							<span class="hash request">
								<strong class="type">Request</strong>
								
									
										curl -v -k -X PUT -d "api_key=G6qq3KzWQVi9zgfFVXud&amount=102&expiration_date=2013-02-02" https://dev.affinitystop.com:3000/api/v1/members/1/club_cash
									
								
							</span>
							<span class="hash response">
								<strong class="type">Response</strong>
								
									
										{"message":"Member updated successfully","code":"000"}
									
								
							</span>
							<span class="description">
								
									
										Example response to a valid request.
									
								
							</span>
						</div>
					
				</div>
			
		</div>	
    
		<div class="method">
			<p class="method_desc">Updates member's next retry bill date.</p>
			<h3 class="resource_url"><strong>/api/v1/members/:id/next_bill_date</strong> [PUT]</h3>

			<div class="parameters">	
				
					<div class="required">
						<h4>Required Parameters</h4>
						
							<ul>
								<li>
									<span class="name">api_key</span>
									<span class="type">String</span>
									<span class="text">Agent's authentication token. This token allows us to check if the agent is allowed to request this action.</span>
								</li>
							</ul>
						
							<ul>
								<li>
									<span class="name">id</span>
									<span class="type">Integer</span>
									<span class="text">Member's ID. Integer autoincrement value that is used by platform. Have in mind this is part of the url.</span>
								</li>
							</ul>
						
							<ul>
								<li>
									<span class="name">next_bill_date</span>
									<span class="type">String</span>
									<span class="text">Date when we should bill this member, an it is stored with datetime format. It also supports UTC format. Have in mind that in this case it is not necessary to send the offset, since we set it according to the club's configuration.(Format "yyyy-mm-dd", “dd/mm/yyyy” or "yyyy-mm-ddThh:mm:ss") (Eg: "2013-04-23" or "2013-04-23T15:17:09")</span>
								</li>
							</ul>
						
					</div>
				

				
			</div><!-- parameters -->
			
			
				<div class="response_fields">
					<h4>Response Fields</h4>
					
						<ul>
							<li>
								<span class="name">message</span>
								<span class="type">String</span>
								<span class="text">Shows the method result.</span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">code</span>
								<span class="type">Integer</span>
								<span class="text">Code related to the method result.</span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">errors</span>
								<span class="type">Hash</span>
								<span class="text">A hash with member and next_bill_date errors.</span>
							</li>
						</ul>
					
				</div>
			
			
			
				<div class="examples">
					<h4>Examples</h4>
					
						<div class="example">
							
							
							
							<span class="description">
								
									
										Example of valid request.
									
								
							</span>
							<span class="hash request">
								<strong class="type">Request</strong>
								
									
										curl -v -k -X PUT -d "api_key=G6qq3KzWQVi9zgfFVXud&next_bill_date=2013-05-21" https://dev.affinitystop.com:3000/api/v1/members/1/next_bill_date
									
								
							</span>
							<span class="hash response">
								<strong class="type">Response</strong>
								
									
										{"message":"Next bill date changed to 2013-05-21","code":"000"}
									
								
							</span>
							<span class="description">
								
									
										Example response to a valid request.
									
								
							</span>
						</div>
					
				</div>
			
		</div>	
    
		<div class="method">
			<p class="method_desc">Gets an array with all member's id that were updated between the dates given.</p>
			<h3 class="resource_url"><strong>/api/v1/members/find_all_by_updated/:club_id/:start_date/:end_date</strong> [POST]</h3>

			<div class="parameters">	
				
					<div class="required">
						<h4>Required Parameters</h4>
						
							<ul>
								<li>
									<span class="name">api_key</span>
									<span class="type">String</span>
									<span class="text">Agent's authentication token. This token allows us to check if the agent is allowed to request this action.</span>
								</li>
							</ul>
						
							<ul>
								<li>
									<span class="name">club_id</span>
									<span class="type">Integer</span>
									<span class="text">Club's ID needed to find the club where we are going to check for members.</span>
								</li>
							</ul>
						
							<ul>
								<li>
									<span class="name">start_date</span>
									<span class="type">String</span>
									<span class="text">Date where we will start the query from. This date must be in datetime format. Have in mind that this value is part of the url.</span>
								</li>
							</ul>
						
							<ul>
								<li>
									<span class="name">end_date</span>
									<span class="type">String</span>
									<span class="text">Date where we will end the query. This date must be in datetime format. Have in mind that this value is part of the url.</span>
								</li>
							</ul>
						
					</div>
				

				
			</div><!-- parameters -->
			
			
				<div class="response_fields">
					<h4>Response Fields</h4>
					
						<ul>
							<li>
								<span class="name">message</span>
								<span class="type">String</span>
								<span class="text">Shows the method result. This message will be shown when there is an error.</span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">list</span>
								<span class="type">Array</span>
								<span class="text">Array with member's id updated between the dates given. This list will be returned only when this method is success.</span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">code</span>
								<span class="type">String</span>
								<span class="text">Code related to the method result.</span>
							</li>
						</ul>
					
				</div>
			
			
			
				<div class="examples">
					<h4>Examples</h4>
					
						<div class="example">
							
							
							
							<span class="description">
								
									
										Example of valid request.
									
								
							</span>
							<span class="hash request">
								<strong class="type">Request</strong>
								
									
										curl -v -k -X POST -d "api_key=G6qq3KzWQVi9zgfFVXud" https://dev.affinitystop.com:3000/api/v1/members/find_all_by_updated/2/2013-03-20/2013-03-22
									
								
							</span>
							<span class="hash response">
								<strong class="type">Response</strong>
								
									
										{ "list":[20,21,22,24,25],"code":"000" }
									
								
							</span>
							<span class="description">
								
									
										Example response to a valid request.
									
								
							</span>
						</div>
					
				</div>
			
		</div>	
    
		<div class="method">
			<p class="method_desc">Gets an array with all member's id that were created between the dates given.</p>
			<h3 class="resource_url"><strong>/api/v1/members/find_all_by_created/:club_id/:start_date/:end_date</strong> [POST]</h3>

			<div class="parameters">	
				
					<div class="required">
						<h4>Required Parameters</h4>
						
							<ul>
								<li>
									<span class="name">api_key</span>
									<span class="type">String</span>
									<span class="text">Agent's authentication token. This token allows us to check if the agent is allowed to request this action.</span>
								</li>
							</ul>
						
							<ul>
								<li>
									<span class="name">club_id</span>
									<span class="type">Integer</span>
									<span class="text">Club's ID needed to find the club where we are going to check for members.</span>
								</li>
							</ul>
						
							<ul>
								<li>
									<span class="name">start_date</span>
									<span class="type">String</span>
									<span class="text">Date where we will start the query from. This date must be in datetime format. Have in mind that this value is part of the url.</span>
								</li>
							</ul>
						
							<ul>
								<li>
									<span class="name">end_date</span>
									<span class="type">String</span>
									<span class="text">Date where we will end the query. This date must be in datetime format. Have in mind that this value is part of the url.</span>
								</li>
							</ul>
						
					</div>
				

				
			</div><!-- parameters -->
			
			
				<div class="response_fields">
					<h4>Response Fields</h4>
					
						<ul>
							<li>
								<span class="name">message</span>
								<span class="type">String</span>
								<span class="text">Shows the method result. This message will be shown when there is an error.</span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">list</span>
								<span class="type">Array</span>
								<span class="text">Array with member's id created between the dates given. This list will be returned only when this method is success.</span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">code</span>
								<span class="type">String</span>
								<span class="text">Code related to the method result.</span>
							</li>
						</ul>
					
				</div>
			
			
			
				<div class="examples">
					<h4>Examples</h4>
					
						<div class="example">
							
							
							
							<span class="description">
								
									
										Example of valid request.
									
								
							</span>
							<span class="hash request">
								<strong class="type">Request</strong>
								
									
										curl -v -k -X POST -d "api_key=G6qq3KzWQVi9zgfFVXud" https://dev.affinitystop.com:3000/api/v1/members/find_all_by_created/2/2013-03-20/2013-03-22
									
								
							</span>
							<span class="hash response">
								<strong class="type">Response</strong>
								
									
										{"list":[11349950041,11349950042,11349950043,11349950044,11349950045,11349950046,11349950047,11349950048],"code":"000"}
									
								
							</span>
							<span class="description">
								
									
										Example response to a valid request.
									
								
							</span>
						</div>
					
				</div>
			
		</div>	
    
		<div class="method">
			<p class="method_desc">Sets member's cancelation date. In case the member is already canceled, or it has the cancelation date set, we won't excecute the request.</p>
			<h3 class="resource_url"><strong>/api/v1/members/:id/cancel</strong> [PUT]</h3>

			<div class="parameters">	
				
					<div class="required">
						<h4>Required Parameters</h4>
						
							<ul>
								<li>
									<span class="name">api_key</span>
									<span class="type">String</span>
									<span class="text">Agent's authentication token. This token allows us to check if the agent is allowed to request this action.</span>
								</li>
							</ul>
						
							<ul>
								<li>
									<span class="name">id</span>
									<span class="type">Integer</span>
									<span class="text">Member's ID. Integer autoincrement value that is used by platform. Have in mind this is part of the url.</span>
								</li>
							</ul>
						
							<ul>
								<li>
									<span class="name">cancel_date</span>
									<span class="type">String</span>
									<span class="text">Date when we are going to cancel the member. This date is stored in date format. (Format: "yyyy-mm-dd")</span>
								</li>
							</ul>
						
							<ul>
								<li>
									<span class="name">reason</span>
									<span class="type">String</span>
									<span class="text">Reason why the member is being canceled.</span>
								</li>
							</ul>
						
					</div>
				

				
			</div><!-- parameters -->
			
			
				<div class="response_fields">
					<h4>Response Fields</h4>
					
						<ul>
							<li>
								<span class="name">message</span>
								<span class="type">String</span>
								<span class="text">Shows the method result.</span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">code</span>
								<span class="type">Integer</span>
								<span class="text">Code related to the method result.</span>
							</li>
						</ul>
					
				</div>
			
			
			
				<div class="examples">
					<h4>Examples</h4>
					
						<div class="example">
							
							
							
							<span class="description">
								
									
										Example of valid request.
									
								
							</span>
							<span class="hash request">
								<strong class="type">Request</strong>
								
									
										curl -v -k -X PUT -d "api_key=G6qq3KzWQVi9zgfFVXud&cancel_date=2013-05-21&reason=Did not know I have enrolled" https://dev.affinitystop.com:3000/api/v1/members/3/cancel
									
								
							</span>
							<span class="hash response">
								<strong class="type">Response</strong>
								
									
										{"message":"Member cancellation scheduled to 2013-05-21 - Reason: Did not know I have enrolled","code":"000"}
									
								
							</span>
							<span class="description">
								
									
										Example response to a valid request.
									
								
							</span>
						</div>
					
				</div>
			
		</div>	
    
		<div class="method">
			<p class="method_desc">Change actual subscription plans related to a member. (DEPRECATED by 'update_terms_of_membership')</p>
			<h3 class="resource_url"><strong>/api/v1/members/:id/change_terms_of_membership</strong> [POST]</h3>

			<div class="parameters">	
				
					<div class="required">
						<h4>Required Parameters</h4>
						
							<ul>
								<li>
									<span class="name">id</span>
									<span class="type">Integer</span>
									<span class="text">Member's ID. Integer autoincrement value that is used by platform. Have in mind this is part of the url.</span>
								</li>
							</ul>
						
							<ul>
								<li>
									<span class="name">terms_of_membership_id</span>
									<span class="type">Integer</span>
									<span class="text">New Subscription plan's ID to set on members.</span>
								</li>
							</ul>
						
					</div>
				

				
			</div><!-- parameters -->
			
			
				<div class="response_fields">
					<h4>Response Fields</h4>
					
						<ul>
							<li>
								<span class="name">message</span>
								<span class="type">String</span>
								<span class="text">Shows the method results and also informs the errors.</span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">code</span>
								<span class="type">String</span>
								<span class="text">Code related to the method result.</span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">member_id</span>
								<span class="type">Integer</span>
								<span class="text">Member's id. Integer autoincrement value that is used by platform. This value will be returned only if the member is enrolled successfully.</span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">errors</span>
								<span class="type">Hash</span>
								<span class="text">A hash with members and credit card errors.
<ul>
  <li> <strong>key</strong> member's field name with error. (Eg: first_name, last_name, etc.). In the particular case that one or more of credit_card's field are wrong, the key will be "credit_card", and the value will be a hash that follows the same logic as this error hash. (Eg: "credit_card":{"number":["is required"],"expire_month":["is required"],"expire_year":["is required"]})  </li>
  <li> <strong>value</strong> Array of strings with errors. (Eg: ["can't be blank","is invalid"]). </li>
</ul></span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">autologin_url</span>
								<span class="type">String</span>
								<span class="text">Url provided by Drupal, used to autologin a member into it. This URL is used by campaigns in order to redirect members to their drupal account. This value wll be returned as blank in case the club is not related to drupal.</span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">api_role</span>
								<span class="type">String</span>
								<span class="text">Only for drupal. We will send the members's api role id within this field.</span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">bill_date</span>
								<span class="type">String</span>
								<span class="text">Only for drupal. Date when the billing will be done. In case bill date is not set (for example for applied member) the date will be send as blank.</span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">status</span>
								<span class="type">String</span>
								<span class="text">Member's membership status after enrolling. There are two possibles status when the member is enrolled:
<ul>
  <li><strong>provisional</strong> The member will be within a period of provisional. This period will be set according to the subscription plan the member was enrolled with. Once the period finishes, the member will be billed, and if it is successful, it will be set as 'active'. </li>
  <li><strong>applied</strong> Member is in confirmation process. An agent will be in charge of accepting or rejecting the enroll. In case the enroll is accepeted, the member will be set as provisional. On the other hand, if the member is reject, it will be set as lapsed. </li>
</ul></span>
							</li>
						</ul>
					
				</div>
			
			
			
		</div>	
    
		<div class="method">
			<p class="method_desc">Change actual subscription plans related to a member, with the option to prorate it.</p>
			<h3 class="resource_url"><strong>/api/v1/members/update_terms_of_membership</strong> [POST]</h3>

			<div class="parameters">	
				
					<div class="required">
						<h4>Required Parameters</h4>
						
							<ul>
								<li>
									<span class="name">id_or_email</span>
									<span class="type">String</span>
									<span class="text">Member's ID or Member's email. You can either send id or email within this value. The ID is an integer autoincrement value that is used by platform.</span>
								</li>
							</ul>
						
							<ul>
								<li>
									<span class="name">terms_of_membership_id</span>
									<span class="type">Integer</span>
									<span class="text">New subscription plan's ID to set on members.</span>
								</li>
							</ul>
						
					</div>
				

				
					<div class="optional">
						<h4>Optional Parameters</h4>
						
							<ul>
								<li>
									<span class="name">prorate</span>
									<span class="type">Boolean</span>
									<span class="text">Boolean value to define if we will proceed with the prorate logic, or not. (1= follow prorate logic, 0= do not follow prorate logic). Default value is 1 (true)</span>
								</li>
							</ul>
						
							<ul>
								<li>
									<span class="name">credit_card</span>
									<span class="type">Hash</span>
									<span class="text">Hash with credit cards information. It must have the following information:
<ul>
  <li><strong>set_active</strong> Boolean value to decide whether or not we will set the credit card as active. (1= set credit card as active, 0= do not set credit card as active). Default value 1 </li>
  <li><strong>number</strong> Number of member's credit card, from where we will charge the membership or any other service. This value won't be save, but instead we will save a token obtained from the payment gateway. (We accept numbers and characters like "-", whitespaces and "/") </li>
  <li><strong>expire_month</strong> The month (in numbers) in which the credit card will expire. Eg. For june it would be 6. </li>
  <li><strong>expire_year</strong> The year (in numbers) in which the credit card will expire. Have in mind it is the complete year with four digits (Eg. 2014) </li>
</ul></span>
								</li>
							</ul>
						
					</div>
				
			</div><!-- parameters -->
			
			
				<div class="response_fields">
					<h4>Response Fields</h4>
					
						<ul>
							<li>
								<span class="name">message</span>
								<span class="type">String</span>
								<span class="text">Shows the method results and also informs the errors.</span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">code</span>
								<span class="type">String</span>
								<span class="text">Code related to the method result.</span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">member_id</span>
								<span class="type">Integer</span>
								<span class="text">Member's id. Integer autoincrement value that is used by platform. This value will be returned only if the member is enrolled successfully.</span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">errors</span>
								<span class="type">Hash</span>
								<span class="text">A hash with members and credit card errors.
<ul>
  <li> <strong>key</strong> member's field name with error. (Eg: first_name, last_name, etc.). In the particular case that one or more of credit_card's field are wrong, the key will be "credit_card", and the value will be a hash that follows the same logic as this error hash. (Eg: "credit_card":{"number":["is required"],"expire_month":["is required"],"expire_year":["is required"]})  </li>
  <li> <strong>value</strong> Array of strings with errors. (Eg: ["can't be blank","is invalid"]). </li>
</ul></span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">autologin_url</span>
								<span class="type">String</span>
								<span class="text">Url provided by Drupal, used to autologin a member into it. This URL is used by campaigns in order to redirect members to their drupal account. This value wll be returned as blank in case the club is not related to drupal.</span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">api_role</span>
								<span class="type">String</span>
								<span class="text">Only for drupal. We will send the members's api role id within this field.</span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">bill_date</span>
								<span class="type">String</span>
								<span class="text">Only for drupal. Date when the billing will be done. In case bill date is not set (for example for applied member) the date will be send as blank.</span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">status</span>
								<span class="type">String</span>
								<span class="text">Member's membership status after enrolling. There are two possibles status when the member is enrolled:
<ul>
  <li><strong>provisional</strong> The member will be within a period of provisional. This period will be set according to the subscription plan the member was enrolled with. Once the period finishes, the member will be billed, and if it is successful, it will be set as 'active'. </li>
  <li><strong>applied</strong> Member is in confirmation process. An agent will be in charge of accepting or rejecting the enroll. In case the enroll is accepeted, the member will be set as provisional. On the other hand, if the member is reject, it will be set as lapsed. </li>
</ul></span>
							</li>
						</ul>
					
				</div>
			
			
			
		</div>	
    
		<div class="method">
			<p class="method_desc">Charge a non-recurrent amount to a member. This could be either a "donation" or an "one-time" only amount.</p>
			<h3 class="resource_url"><strong>/api/v1/members/:id/sale</strong> [POST]</h3>

			<div class="parameters">	
				
					<div class="required">
						<h4>Required Parameters</h4>
						
							<ul>
								<li>
									<span class="name">amount</span>
									<span class="type">Float</span>
									<span class="text">Amount to charge the member.</span>
								</li>
							</ul>
						
							<ul>
								<li>
									<span class="name">description</span>
									<span class="type">String</span>
									<span class="text">Description of why the member is being charged.</span>
								</li>
							</ul>
						
							<ul>
								<li>
									<span class="name">type</span>
									<span class="type">String</span>
									<span class="text">Type of the operation. It could be either "donation" or "one-time".</span>
								</li>
							</ul>
						
					</div>
				

				
			</div><!-- parameters -->
			
			
				<div class="response_fields">
					<h4>Response Fields</h4>
					
						<ul>
							<li>
								<span class="name">message</span>
								<span class="type">String</span>
								<span class="text">Shows the method results and also informs the errors.</span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">code</span>
								<span class="type">String</span>
								<span class="text">Code related to the method result.</span>
							</li>
						</ul>
					
				</div>
			
			
			
				<div class="examples">
					<h4>Examples</h4>
					
						<div class="example">
							
							
							
							<span class="description">
								
									
										Example of valid request.
									
								
							</span>
							<span class="hash request">
								<strong class="type">Request</strong>
								
									
										curl -v -k -X POST -d "api_key=YUiVENNdFbNpRiYFd83Q&amount=10&description=paid related to product&type=one-time" https://dev.affinitystop.com:3000/api/v1/members/3/sale
									
								
							</span>
							<span class="hash response">
								<strong class="type">Response</strong>
								
									
										{"message":"Member billed successfully $10 Transaction id: 6043044a-1185-4323-aa46-64cd4941d511. Reason: paid related to product","code":"000"}
									
								
							</span>
							<span class="description">
								
									
										Example response to a valid request.
									
								
							</span>
						</div>
					
				</div>
			
		</div>	
    
		<div class="method">
			<p class="method_desc">Help to manage PTX content, allowing to pulling content on the source page and a way to verify if a user is a member or not. The member will be search within agent's related club.</p>
			<h3 class="resource_url"><strong>/api/v1/members/get_banner_by_email</strong> [POST]</h3>

			<div class="parameters">	
				

				
					<div class="optional">
						<h4>Optional Parameters</h4>
						
							<ul>
								<li>
									<span class="name">email</span>
									<span class="type">String</span>
									<span class="text">Members personal email. If no email is given, or if the email is invalid, we will answer with non-member banner and landing urls.</span>
								</li>
							</ul>
						
					</div>
				
			</div><!-- parameters -->
			
			
				<div class="response_fields">
					<h4>Response Fields</h4>
					
						<ul>
							<li>
								<span class="name">message</span>
								<span class="type">String</span>
								<span class="text">Shows the method results and also informs the errors.</span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">member_id</span>
								<span class="type">Integer</span>
								<span class="text">Member's id. Integer autoincrement value that is used by platform. This value will be returned only if the member is already created.</span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">landing_url</span>
								<span class="type">String</span>
								<span class="text">Club's landing_url. The value returned will depend if the email belongs to a created member or not.</span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">banner_url</span>
								<span class="type">String</span>
								<span class="text">Club's banner_url. The value returned will depend if the email belongs to a created member or not.</span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">message</span>
								<span class="type">String</span>
								<span class="text">Shows the method results and also informs the errors.</span>
							</li>
						</ul>
					
						<ul>
							<li>
								<span class="name">code</span>
								<span class="type">String</span>
								<span class="text">Code related to the method result.</span>
							</li>
						</ul>
					
				</div>
			
			
			
				<div class="examples">
					<h4>Examples</h4>
					
						<div class="example">
							
							
							
							<span class="description">
								
									
										Example of valid request.
									
								
							</span>
							<span class="hash request">
								<strong class="type">Request</strong>
								
									
										curl -v -k -X POST -d "api_key=5yzCzGvsVCSYkycjaKjS&email=email@domain.com" https://dev.affinitystop.com:3000/api/v1/members/get_banner_by_email
									
								
							</span>
							<span class="hash response">
								<strong class="type">Response</strong>
								
									
										{"message":"Email address belongs to an already created member.","landing_url":"http://member_landing.com","banner_url":"http://member_banner.com","member_id":15,"code":"000"}
									
								
							</span>
							<span class="description">
								
									
										Example response to a valid request.
									
								
							</span>
						</div>
					
				</div>
			
		</div>	
    
  </div>

</div>













	</div>
    
    <div id="footer">
  Generated on Mon Feb  1 13:33:51 2016 with ruby-2.2.0
</div>

  </body>
</html>