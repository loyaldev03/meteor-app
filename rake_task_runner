#!/bin/sh

# needs to find ruby and rake binaries
export PATH=$PATH:/usr/local/bin

# 15 0 * * * rake_task_runner
logfile="/tmp/cron_rake.log"

echo "PATH variable => `printenv PATH`"
COMMON_CONFIG="cd /var/www/backend-sac-platform/current && RAILS_ENV=$1"
LOG_TO_FILE=" >> $logfile 2>&1"
`$COMMON_CONFIG rake members:cancel $LOG_TO_FILE`
`$COMMON_CONFIG rake mes:chargeback_report $LOG_TO_FILE`
# billing should be executed after cancel jobs finishes
`$COMMON_CONFIG rake billing:send_prebill $LOG_TO_FILE`
`$COMMON_CONFIG rake members:process_fulfillments $LOG_TO_FILE`
`$COMMON_CONFIG rake members:process_club_cash $LOG_TO_FILE`
`$COMMON_CONFIG rake billing:for_today $LOG_TO_FILE`
`$COMMON_CONFIG rake members:send_pillar_emails $LOG_TO_FILE`
`$COMMON_CONFIG rake members:send_happy_birthday $LOG_TO_FILE`

